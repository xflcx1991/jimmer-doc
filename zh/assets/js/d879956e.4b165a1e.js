"use strict";(self.webpackChunkdocusaurus_code=self.webpackChunkdocusaurus_code||[]).push([[1350],{68398:(n,e,l)=>{l.r(e),l.d(e,{assets:()=>u,contentTitle:()=>x,default:()=>g,frontMatter:()=>h,metadata:()=>i,toc:()=>p});const i=JSON.parse('{"id":"mutation/save-command/investigation","title":"\u8fdd\u53cd\u7ea6\u675f\u5f02\u5e38\u5904\u7406","description":"\u57fa\u672c\u6982\u5ff5","source":"@site/i18n/zh/docusaurus-plugin-content-docs/current/mutation/save-command/investigation.mdx","sourceDirName":"mutation/save-command","slug":"/mutation/save-command/investigation","permalink":"/jimmer-doc/zh/docs/mutation/save-command/investigation","draft":false,"unlisted":false,"editUrl":"https://github.com/babyfish-ct/jimmer-doc/edit/main/i18n/zh/docusaurus-plugin-content-docs/current/mutation/save-command/investigation.mdx","tags":[],"version":"current","lastUpdatedAt":1734792507000,"sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"\u8fdd\u53cd\u7ea6\u675f\u5f02\u5e38\u5904\u7406"},"sidebar":"tutorialSidebar","previous":{"title":"\u8131\u94a9\u64cd\u4f5c","permalink":"/jimmer-doc/zh/docs/mutation/save-command/association/dissociation"},"next":{"title":"\u4e50\u89c2\u9501","permalink":"/jimmer-doc/zh/docs/mutation/save-command/optimistic-locking"}}');var s=l(74848),t=l(28453),a=l(11470),r=l(19365);function o(n){const e={code:"code",pre:"pre",...(0,t.R)(),...n.components};return(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'public void addBookStore(String name) {\n\n    BookTable table = BookTable.$;\n    boolean exists = sqlClient.createQuery(table)\n        .where(table.name().eq(name))\n        .exists();\n    if (exists) {\n        throw new IllegalArgumentException(\n            "Cannot create new book store \\"\n            name +\n            \\" because it already exists"\n        );\n    }\n\n    return sqlClient.insert(\n        Immutables.createBookStore(draft -> {\n            draft.setName(name);\n        })\n    );\n}\n'})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:'fun addBookStore(name: String) {\n    \n    val exists = sqlCient.createQuery(BookStore::class) {\n        where(table.name eq name)\n        select(table)\n    }.exists()\n    if (exists) {\n        throw IllegalArgumentException(\n            "Cannot create new book store \\"\n            name +\n            \\" because it already exists"\n        )\n    }\n\n    sqlCient.insert(\n        BookStore {\n            name = name\n        }\n    )\n}\n'})})})]})}function c(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(o,{...n})}):o(n)}var d=l(74400);const h={sidebar_position:5,title:"\u8fdd\u53cd\u7ea6\u675f\u5f02\u5e38\u5904\u7406"},x=void 0,u={},p=[{value:"\u57fa\u672c\u6982\u5ff5",id:"\u57fa\u672c\u6982\u5ff5",level:2},{value:"\u68c0\u67e5Id\u662f\u5426\u51b2\u7a81",id:"\u68c0\u67e5id\u662f\u5426\u51b2\u7a81",level:2},{value:"\u68c0\u67e5Key\u662f\u5426\u51b2\u7a81",id:"\u68c0\u67e5key\u662f\u5426\u51b2\u7a81",level:2},{value:"\u68c0\u67e5\u5173\u8054\u5bf9\u8c61\u662f\u5426\u5b58\u5728",id:"\u68c0\u67e5\u5173\u8054\u5bf9\u8c61\u662f\u5426\u5b58\u5728",level:2},{value:"\u5047\u5916\u952e",id:"\u5047\u5916\u952e",level:3},{value:"\u771f\u5916\u952e",id:"\u771f\u5916\u952e",level:3},{value:"\u7528\u6237\u5f02\u5e38\u7ffb\u8bd1\u5668",id:"\u7528\u6237\u5f02\u5e38\u7ffb\u8bd1\u5668",level:2},{value:"\u5f02\u5e38\u7ffb\u8bd1\u63a5\u53e3",id:"\u5f02\u5e38\u7ffb\u8bd1\u63a5\u53e3",level:3},{value:"\u591a\u79cd\u6ce8\u518c\u65b9\u6cd5",id:"\u591a\u79cd\u6ce8\u518c\u65b9\u6cd5",level:3},{value:"\u5b9e\u73b0<code>translate</code>\u65b9\u6cd5",id:"\u5b9e\u73b0translate\u65b9\u6cd5",level:3}];function j(n){const e={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h2,{id:"\u57fa\u672c\u6982\u5ff5",children:"\u57fa\u672c\u6982\u5ff5"}),"\n",(0,s.jsx)(e.p,{children:"\u5728\u65e5\u5e38\u9879\u76ee\u5f00\u53d1\u4e2d\uff0c\u6709\u4e00\u4e2a\u975e\u5e38\u5934\u75bc\u7684\u95ee\u9898\uff0c\u5c31\u662f\u5c06\u56e0\u8fdd\u53cd\u6570\u636e\u5e93\u7ea6\u675f\u7684\u9519\u8bef\u4fe1\u606f\u7ffb\u8bd1\u4e3a\u5bf9\u7528\u6237\u53cb\u597d\u7684\u9519\u8bef\u4fe1\u606f\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u4ee5\u65e0\u6cd5\u7b80\u5355\u5730\u901a\u8fc7\u8f93\u5165\u6570\u636e\u9a8c\u8bc1\u4e3a\u51c6\uff0c\u6570\u636e\u5e93\u5b58\u5728\u5982\u4e0b\u4e09\u79cd\u7ea6\u675f\uff0c\u4e00\u65e6\u88ab\u8fdd\u80cc\u96be\u4ee5\u5904\u7406\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u4e3b\u952e\u7ea6\u675f"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u552f\u4e00\u7ea6\u675f ",(0,s.jsx)(e.em,{children:"(\u6216\u552f\u4e00\u7d22\u5f15)"})]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5916\u952e\u7ea6\u675f"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["\u4e3a\u4e86\u7edf\u4e00\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4ea7\u54c1\uff0cSQL\u6807\u51c6\u89c4\u5b9a\u56e0\u8fdd\u53cd\u7ea6\u675f\u800c\u5bfc\u81f4\u7684\u9519\u8bef\u7c7b\u522b\u7801\u4e3a",(0,s.jsxs)(e.a,{href:"https://en.wikipedia.org/wiki/SQLSTATE",children:["23 ",(0,s.jsx)(e.em,{children:"(integrity constraint violation)"})]}),"\uff0c\n\u6240\u6709\u4e8e\u6b64\u76f8\u5173\u7684\u9519\u8befstate\u90fd\u4ee5",(0,s.jsx)(e.code,{children:"23"}),"\u5f00\u5934\u3002"]}),"\n",(0,s.jsx)(e.p,{children:"\u4f46\u662f\uff0c\u6807\u51c6\u7684\u89c4\u8303\u5316\u4e5f\u4ec5\u9650\u4e8e\u6b64\u3002\u81f3\u4e8e\u66f4\u7ec6\u8282\u7684\u95ee\u9898\uff0c\u8b6c\u5982\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u88ab\u8fdd\u80cc\u7684\u7ea6\u675f\u662f\u4ec0\u4e48"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5982\u4f55\u6309\u7167\u7ea6\u675f\u540d\u4ece\u6570\u636e\u5e93\u5b57\u5178\u4e2d\u83b7\u53d6\u53d1\u751f\u9519\u8bef\u7684\u8868\u540d\u548c\u5217\u540d"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u6700\u91cd\u8981\u7684\u95ee\u9898\uff0c\u7a76\u7adf\u662f\u54ea\u6761\u6570\u636e\u7684\u4fee\u6539\u884c\u4e3a\u5bfc\u81f4\u4e86\u5f02\u5e38"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u4e0d\u540c\u6570\u636e\u5e93\u4ea7\u54c1\u884c\u4e3a\u5e76\u4e0d\u7edf\u4e00\uff0c\u5e76\u7f3a\u4e4f\u6e05\u6670\u7684API\u83b7\u53d6\u8fd9\u4e9b\u4fe1\u606f\u3002"}),"\n",(0,s.jsxs)(e.p,{children:["\u4e3a\u4e86\u7ed9\u4e88\u7528\u6237\u6e05\u6670\u7684\u9519\u8bef\u63cf\u8ff0\uff0c\u5f88\u591a\u4e1a\u52a1\u9879\u76ee\u91c7\u7528\u4e00\u79cd\u7b80\u5355\u7c97\u66b4\u65b9\u6cd5\uff0c\u5728\u6267\u884c\u4fee\u6539\u524d\uff0c",(0,s.jsx)(d.l,{buttonText:"\u901a\u8fc7\u67e5\u8be2\u9884\u5224",size:"small",children:(0,s.jsx)(c,{})}),"\u7a0d\u540e\u5373\u5c06\u6267\u884c\u7684\u64cd\u4f5c\u662f\u5426\u5b89\u5168\u3002"]}),"\n",(0,s.jsx)(e.p,{children:"\u7136\u800c\uff0c\u8fd9\u79cd\u8fd9\u79cd\u4e8b\u5148\u9884\u5224\u884c\u4e3a\u7684\u7f3a\u70b9\u5f88\u591a\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5f00\u53d1\u4eba\u5458\u9700\u8981\u4e0d\u538c\u5176\u70e6\u5730\u7f16\u5199\u5404\u79cd\u4e8b\u5148\u9884\u5224\u4ee3\u7801\uff0c\u5f00\u53d1\u6210\u672c\u5c45\u9ad8\u4e0d\u4e0b"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u4ec5\u9002\u5408\u7b80\u5355\u7684\u5355\u6761\u6570\u636eDML\u4fee\u6539\u884c\u4e3a\uff0c\u5bf9\u4fdd\u5b58\u6307\u4ee4\u8fd9\u79cd\u9012\u5f52\u6279\u91cf\u4fdd\u5b58\u6df1\u5c42\u6b21\u6570\u636e\u7ed3\u6784\u7684\u9ad8\u7ea7\u884c\u4e3a\u5b8c\u5168\u4e0d\u9002\u5408"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u6027\u80fd\u4f4e\uff0c\u53d1\u751f\u9519\u8bef\u662f\u5c0f\u6982\u7387\u4e8b\u4ef6\uff0c\u6bcf\u6b21\u90fd\u4e8b\u5148\u9884\u5224\u662f\u4e00\u79cd\u6d6a\u8d39"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u56e0\u6b64\uff0cJimmer\u91c7\u7528\u5982\u4e0b\u7b56\u7565"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u91c7\u7528\u4e8b\u540e\u8c03\u67e5\u7684\u65b9\u5f0f\uff0c\u5148\u76f4\u63a5\u4fee\u6539\u6570\u636e\u5e93\uff0c\u5982\u679c\u4e8b\u540e\u53d1\u73b0\u6570\u636e\u5e93\u62a5\u544a\u4e86\u7ea6\u675f\u88ab\u8fdd\u80cc\u7684\u9519\u8bef\uff0c\u518d\u8c03\u67e5\u9519\u8bef\u539f\u56e0"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5728\u9519\u8bef\u8c03\u67e5\u8fc7\u7a0b\u4e2d\uff0c\u5229\u7528\u67e5\u8be2\u83b7\u53d6\u5c3d\u53ef\u80fd\u591a\u7684\u4fe1\u606f\uff0c\u5c06"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5bfc\u81f4\u975e\u6cd5\u64cd\u4f5c\u7684\u5bf9\u8c61\u5728\u88ab\u4fdd\u5b58\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u8def\u5f84"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5bfc\u81f4\u9519\u8bef\u7684\u5b9e\u4f53\u7c7b\u578b\u548c\u76f8\u5173\u5c5e\u6027\u540d"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5bfc\u81f4\u9519\u8bef\u7684\u5177\u4f53\u5bf9\u8c61\u548c\u76f8\u5173\u6570\u636e"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u5168\u90e8\u62a5\u544a\u7ed9\u7528\u6237"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5141\u8bb8\u7528\u6237\u81ea\u5b9a\u4e49\u5f02\u5e38\u7ffb\u8bd1\u5668\uff0c\u5c06Jimmer\u901a\u8fc7\u8c03\u67e5\u5f97\u5230\u7684\u5f02\u5e38\u8fdb\u4e00\u6b65\u7ffb\u8bd1\u6210\u5bf9\u6700\u7ec8\u7528\u6237\u53cb\u597d\u7684\u4fe1\u606f"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.admonition,{type:"info",children:[(0,s.jsx)(e.p,{children:"\u8c03\u67e5\u6570\u636e\u5e93\u9519\u8bef\u8fd9\u4e2a\u884c\u4e3a\uff0c\u65e2\u53ef\u4ee5\u56e0\u6839\u5bf9\u8c61\u7684\u4fdd\u5b58\u5931\u8d25\u800c\u53d1\u751f\uff0c\u4e5f\u53ef\u4ee5\u56e0\u5173\u8054\u5bf9\u8c61\u7684\u4fdd\u5b58\u5931\u8d25\u800c\u53d1\u751f\u3002Jimmer\u5bf9\u4e8c\u8005\u4e00\u89c6\u540c\u4ec1\uff0c\u6ca1\u6709\u5dee\u5f02\u3002"}),(0,s.jsxs)(e.p,{children:["\u7136\u800c\uff0c\u4e3a\u4e86\u7b80\u5316\u6587\u6863\uff0c\u672c\u6587\u7684\u4f8b\u5b50\u5c3d\u91cf\u793a\u8303\u4fdd\u5b58\u76f8\u5bf9\u7b80\u5355\u7684\u5bf9\u8c61\uff0c\u907f\u514d\u4fdd\u5b58\u8fc7\u6df1\u7684\u6570\u636e\u7ed3\u6784 ",(0,s.jsx)(e.em,{children:"(\u4e8b\u5b9e\u4e0a\uff0c\u5982\u679c\u4fdd\u5b58\u6df1\u5c42\u6b21\u7684\u5173\u8054\u5bf9\u8c61\u5931\u8d25\uff0c\u4e00\u6837\u4f1a\u88ab\u8c03\u67e5"}),")\u3002"]})]}),"\n",(0,s.jsx)(e.h2,{id:"\u68c0\u67e5id\u662f\u5426\u51b2\u7a81",children:"\u68c0\u67e5Id\u662f\u5426\u51b2\u7a81"}),"\n",(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'List<Book> books = Arrays.asList(\n    Immutables.createBook(draft -> {\n        draft.setId(100L);\n        draft.setName("SQL in Action");\n        draft.setEdition(1);\n        draft.setPrice(new BigDecimal("59.9"));\n        draft.setStoreId(2L);\n    }),\n    Immutables.createBook(draft -> {\n        // highlight-next-line\n        draft.setId(7L); // Exists\n        draft.setName("LINQ in Action");\n        draft.setEdition(3);\n        draft.setPrice(new BigDecimal("49.9"));\n        draft.setStoreId(2L);\n    })\n);\n\nsqlClient.insertEntities(books);\n'})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:'val books = listOf(\n    Book { \n        id = 100L\n        name = "SQL in Action"\n        edition = 1\n        price = BigDecimal("59.9")\n        storeId = 2L\n    },\n    Book {\n        // highlight-next-line\n        id = 7L // Exists\n        name = "LINQ in Action"\n        edition = 3\n        price = BigDecimal("49.9")\n        storeId = 2L\n    }\n)\n\nsqlClient.insertEntities(books)\n'})})})]}),"\n",(0,s.jsx)(e.p,{children:"\u8fd9\u6bb5\u4ee3\u7801\u4f1a\u751f\u4ea7\u5982\u4e0b\u4e24\u6761SQL"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u6279\u91cf\u63d2\u5165\u6570\u636e"}),"\n",(0,s.jsxs)(a.A,{groupId:"database",children:[(0,s.jsx)(r.A,{value:"h2",label:"\u7edd\u5927\u90e8\u5206\u6570\u636e\u5e93",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"insert into BOOK(\n    ID, NAME, EDITION, PRICE, STORE_ID\n) values(?, ?, ?, ?, ?)\n/* batch-0: [100, SQL in Action, 1, 59.9, 2] */\n-- highlight-next-line\n/* batch-1: [7, LINQ in Action, 3, 49.9, 2] */\n"})})}),(0,s.jsxs)(r.A,{value:"mysql",label:"Mysql",children:[(0,s.jsx)(e.admonition,{type:"caution",children:(0,s.jsxs)(e.p,{children:["\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cMySQL\u7684\u6279\u91cf\u64cd\u4f5c\u4e0d\u4f1a\u88ab\u91c7\u7528\uff0c\u800c\u91c7\u7528\u591a\u6761SQL\u3002\u5177\u4f53\u7ec6\u8282\u8bf7\u53c2\u8003",(0,s.jsx)(e.a,{href:"./mysql",children:"MySQL\u7684\u95ee\u9898"})]})}),(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"insert into BOOK(\n    ID, NAME, EDITION, PRICE, STORE_ID\n) values(\n    ? /* 100 */, \n    ? /* SQL in Action */, \n    ? /* 1 */, \n    ? /* 59.9 */, \n    ? /* 2  */\n)\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"insert into BOOK(\n    ID, NAME, EDITION, PRICE, STORE_ID\n) values(\n    -- highlight-next-line\n    ? /* 7 */, \n    ? /* LINQ in Action */, \n    ? /* 3 */, \n    ? /* 49.9 */, \n    ? /* 2  */\n)\n"})}),"\n"]}),"\n"]})]})]}),"\n",(0,s.jsxs)(e.p,{children:["\u5176\u4e2d\uff0c\u63d2\u5165\u7b2c\u4e8c\u6761\u6570\u636e\u4f1a\u5bfc\u81f4",(0,s.jsx)(e.code,{children:"id"}),"\u53d1\u751f\u51b2\u7a81"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u8c03\u67e5\u8fdd\u53cd\u7ea6\u675f\u7684\u539f\u56e0"}),"\n",(0,s.jsxs)(a.A,{groupId:"database",children:[(0,s.jsx)(r.A,{value:"scenario-1",label:"\u573a\u666f1",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- highlight-next-line\nPurpose: COMMAND(INVESTIGATE_CONSTRAINT_VIOLATION_ERROR)\nSQL: select\n    tb_1_.ID\nfrom BOOK tb_1_\nwhere\n    tb_1_.ID = ? /* 7 */\n"})})}),(0,s.jsx)(r.A,{value:"scenario-2",label:"\u573a\u666f2",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- highlight-next-line\nPurpose: COMMAND(INVESTIGATE_CONSTRAINT_VIOLATION_ERROR)\nSQL: select\n    tb_1_.ID\nfrom BOOK tb_1_\nwhere\n    tb_1_.ID = any(? /* [100, 7] */)\n"})})})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u573a\u666f1"}),"\n",(0,s.jsxs)(e.p,{children:["\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u6839\u636e\u6279\u91cf\u64cd\u4f5c\u5bfc\u81f4\u7684",(0,s.jsx)(e.code,{children:"java.sql.BatchUpdateException"}),"\u5224\u65ad\u662f\u54ea\u6761\u6570\u636e\u8fdd\u80cc\u4e86\u7ea6\u675f\uff0c\u53ea\u9700\u5bf9\u51fa\u9519\u7684\u90a3\u6761\u6570\u636e\u8fdb\u884c\u8c03\u67e5"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u573a\u666f2"}),"\n",(0,s.jsxs)(e.p,{children:["\u4e0d\u7406\u60f3\u7684\u60c5\u51b5\u4e0b\uff0c\u65e0\u6cd5\u6839\u636e\u6279\u91cf\u64cd\u4f5c\u5bfc\u81f4\u7684",(0,s.jsx)(e.code,{children:"java.sql.BatchUpdateException"}),"\u5224\u65ad\u662f\u54ea\u6761\u6570\u636e\u8fdd\u80cc\u4e86\u7ea6\u675f\uff0c\u4e0d\u5f97\u4e0d\u5bf9\u6240\u6709\u6570\u636e\u8fdb\u884c\u8c03\u67e5"]}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsxs)(e.p,{children:["Postgres\u4ee5\u53ca\u542f\u7528\u4e86\u6279\u91cf\u5316\u80fd\u529b\u7684MySQL(\u53c2\u89c1",(0,s.jsx)(e.a,{href:"./mysql",children:"MySQL\u7684\u95ee\u9898"}),")\uff0c\u90fd\u5c5e\u4e8e\u8fd9\u79cd\u573a\u666f"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u65e0\u8bba\u5982\u4f55\uff0cJimmer\u90fd\u80fd\u8c03\u67e5\u51fa\u95ee\u9898\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u6700\u7ec8\uff0cJimmer\u4f1a\u6839\u636e\u8c03\u67e5\u7ed3\u679c\u629b\u51fa\u5f02\u5e38"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sh",children:'#highlight-next-line\norg.babyfish.jimmer.sql.exception.SaveException$NotUnique: \n    Save error caused by the path: "<root>": \n    Cannot save the entity, the value of the id property \n    "com.yourcompany.yourpoject.model.Book.id" \n    #highlight-next-line\n    is "7" which already exists\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u68c0\u67e5key\u662f\u5426\u51b2\u7a81",children:"\u68c0\u67e5Key\u662f\u5426\u51b2\u7a81"}),"\n",(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'List<Book> books = Arrays.asList(\n    Immutables.createBook(draft -> {\n        draft.setId(11L);\n        draft.setName("GraphQL in Action");\n        draft.setEdition(4);\n    }),\n    Immutables.createBook(draft -> {\n        draft.setId(12L); \n        // highlight-next-line\n        draft.setName("GraphQL in Action"); // `name + edition` exists\n        // highlight-next-line\n        draft.setEdition(1); // `name + edition` exists\n    })\n);\n\nsqlClient.updateEntities(books);\n'})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:'val books = listOf(\n    Book { \n        id = 11L\n        name = "GraphQL in Action"\n        edition = 4\n    },\n    Book {\n        id = 12\n        // highlight-next-line\n        name = "GraphQL in Action" // `name + edition` exists\n        // highlight-next-line\n        edition = 1 // `name + edition` exists\n    }\n)\n\nsqlClient.updateEntities(books)\n'})})})]}),"\n",(0,s.jsx)(e.p,{children:"\u8fd9\u6bb5\u4ee3\u7801\u4f1a\u751f\u4ea7\u5982\u4e0b\u4e24\u6761SQL"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u6279\u91cf\u66f4\u65b0\u6570\u636e"}),"\n",(0,s.jsxs)(a.A,{groupId:"database",children:[(0,s.jsx)(r.A,{value:"h2",label:"\u7edd\u5927\u90e8\u5206\u6570\u636e\u5e93",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"update BOOK\nset\n    NAME = ?,\n    EDITION = ?\nwhere\n    ID = ?\n/* batch-0: [GraphQL in Action, 4, 11] */\n-- highlight-next-line\n/* batch-1: [GraphQL in Action, 1, 12] */\n"})})}),(0,s.jsxs)(r.A,{value:"mysql",label:"Mysql",children:[(0,s.jsx)(e.admonition,{type:"caution",children:(0,s.jsxs)(e.p,{children:["\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cMySQL\u7684\u6279\u91cf\u64cd\u4f5c\u4e0d\u4f1a\u88ab\u91c7\u7528\uff0c\u800c\u91c7\u7528\u591a\u6761SQL\u3002\u5177\u4f53\u7ec6\u8282\u8bf7\u53c2\u8003",(0,s.jsx)(e.a,{href:"./mysql",children:"MySQL\u7684\u95ee\u9898"})]})}),(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"update BOOK\nset\n    NAME = ? /* GraphQL in Action */,\n    EDITION = ? /* 4 */\nwhere\n    ID = ? /* 11 */\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"update BOOK\nset\n    -- highlight-start\n    NAME = ? /* GraphQL in Action */,\n    EDITION = ? /* 1 */\n    -- highlight-end\nwhere\n    ID = ? /* 12 */\n"})}),"\n"]}),"\n"]})]})]}),"\n",(0,s.jsxs)(e.p,{children:["\u5176\u4e2d\uff0c\u4fee\u6539\u7b2c\u4e8c\u6761\u6570\u636e\u4f1a\u5bfc\u81f4",(0,s.jsx)(e.code,{children:"name"}),"\u548c",(0,s.jsx)(e.code,{children:"edition"}),"\u7684\u7ec4\u5408\u53d1\u751f\u51b2\u7a81"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u8c03\u67e5\u8fdd\u53cd\u7ea6\u675f\u7684\u539f\u56e0"}),"\n",(0,s.jsxs)(a.A,{groupId:"database",children:[(0,s.jsx)(r.A,{value:"scenario-1",label:"\u573a\u666f1",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- highlight-next-line\nPurpose: COMMAND(INVESTIGATE_CONSTRAINT_VIOLATION_ERROR)\nselect\n    tb_1_.ID\nfrom BOOK tb_1_\nwhere\n    (tb_1_.NAME, tb_1_.EDITION) = (\n        ? /* GraphQL in Action */, ? /* 4 */\n    )\n"})})}),(0,s.jsx)(r.A,{value:"scenario-2",label:"\u573a\u666f2",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- highlight-next-line\nPurpose: COMMAND(INVESTIGATE_CONSTRAINT_VIOLATION_ERROR)\nSQL: select\n    tb_1_.ID,\n    tb_1_.NAME,\n    tb_1_.EDITION\nfrom BOOK tb_1_\nwhere\n    (tb_1_.NAME, tb_1_.EDITION) in (\n        (? /* GraphQL in Action */, ? /* 4 */), \n        (? /* GraphQL in Action */, ? /* 1 */)\n    )\n"})})})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u573a\u666f1"}),"\n",(0,s.jsxs)(e.p,{children:["\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u6839\u636e\u6279\u91cf\u64cd\u4f5c\u5bfc\u81f4\u7684",(0,s.jsx)(e.code,{children:"java.sql.BatchUpdateException"}),"\u5224\u65ad\u662f\u54ea\u6761\u6570\u636e\u8fdd\u80cc\u4e86\u7ea6\u675f\uff0c\u53ea\u9700\u5bf9\u51fa\u9519\u7684\u90a3\u6761\u6570\u636e\u8fdb\u884c\u8c03\u67e5"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u573a\u666f2"}),"\n",(0,s.jsxs)(e.p,{children:["\u4e0d\u7406\u60f3\u7684\u60c5\u51b5\u4e0b\uff0c\u65e0\u6cd5\u6839\u636e\u6279\u91cf\u64cd\u4f5c\u5bfc\u81f4\u7684",(0,s.jsx)(e.code,{children:"java.sql.BatchUpdateException"}),"\u5224\u65ad\u662f\u54ea\u6761\u6570\u636e\u8fdd\u80cc\u4e86\u7ea6\u675f\uff0c\u4e0d\u5f97\u4e0d\u5bf9\u6240\u6709\u6570\u636e\u8fdb\u884c\u8c03\u67e5"]}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsxs)(e.p,{children:["Postgres\u4ee5\u53ca\u542f\u7528\u4e86\u6279\u91cf\u5316\u80fd\u529b\u7684MySQL(\u53c2\u89c1",(0,s.jsx)(e.a,{href:"./mysql",children:"MySQL\u7684\u95ee\u9898"}),")\uff0c\u90fd\u5c5e\u4e8e\u8fd9\u79cd\u573a\u666f"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u65e0\u8bba\u5982\u4f55\uff0cJimmer\u90fd\u80fd\u8c03\u67e5\u51fa\u95ee\u9898\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u6700\u7ec8\uff0cJimmer\u4f1a\u6839\u636e\u8c03\u67e5\u7ed3\u679c\u629b\u51fa\u5f02\u5e38"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sh",children:'#lighlight-next-line\norg.babyfish.jimmer.sql.exception.SaveException$NotUnique: \n    Save error caused by the path: "<root>": \n    Cannot save the entity, the value of the key properties "[\n        com.yourcompany.yourproject.model.Book.name, \n        com.yourcompany.yourproject.Book.edition\n    #highlight-start\n    ]" are "Tuple2(\n        _1=GraphQL in Action, \n        _2=1\n    )" which already exists\n    #highlight-end\n'})}),"\n",(0,s.jsxs)(e.admonition,{type:"info",children:[(0,s.jsxs)(e.p,{children:["\u5728",(0,s.jsx)(e.a,{href:"../../mapping/advanced/key",children:"\u6620\u5c04\u7bc7/\u8fdb\u9636\u6620\u5c04/Key"}),"\u4e00\u6587\u4e2d\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86\u53ef\u4ee5\u5b9e\u4f53\u914d\u7f6e\u591a\u4e2a\u552f\u4e00\u7ea6\u675f ",(0,s.jsx)(e.em,{children:"(\u6216\u552f\u4e00\u7d22\u5f15)"})," ",(0,s.jsx)(e.em,{children:"(\u4e8b\u5b9e\u4e0a\uff0c\u8be5\u6587\u6863\u8fd8\u672a\u4fee\u6539)"}),"\u3002"]}),(0,s.jsxs)(e.p,{children:["\u5982\u679c\u5b9e\u4f53\u7684\u552f\u4e00\u7ea6\u675f ",(0,s.jsx)(e.em,{children:"(\u6216\u552f\u4e00\u7d22\u5f15)"})," \u4e0d\u6b62\u4e00\u4e2a\uff0cJimmer\u4f1a\u9010\u4e2a\u8c03\u67e5\u3002"]})]}),"\n",(0,s.jsx)(e.h2,{id:"\u68c0\u67e5\u5173\u8054\u5bf9\u8c61\u662f\u5426\u5b58\u5728",children:"\u68c0\u67e5\u5173\u8054\u5bf9\u8c61\u662f\u5426\u5b58\u5728"}),"\n",(0,s.jsxs)(e.p,{children:["\u5728\u4fdd\u5b58\u6307\u4ee4\u4e2d\uff0c\u5173\u8054\u88ab\u5206\u4e3a",(0,s.jsx)(e.a,{href:"/jimmer-doc/zh/docs/mutation/save-command/association/classification",children:"\u957f\u5173\u8054\u548c\u77ed\u5173\u8054"}),"\u3002"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5bf9\u4e8e\u957f\u5173\u8054\u800c\u8a00\uff0c\u5982\u679c\u5173\u8054\u5bf9\u8c61\u4e0d\u5b58\u5728\uff0cJimmer\u4f1a\u5148\u81ea\u52a8\u521b\u5efa\u5173\u8054\u5bf9\u8c61\uff0c\u6545\u800c\u5e76\u4e0d\u5b58\u5728\u5173\u8054\u5bf9\u8c61\u4e0d\u5b58\u5728\u7684\u95ee\u9898\u3002"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5bf9\u4e8e\u77ed\u5173\u8054\u800c\u8a00\uff0cJimmer\u5047\u8bbe\u5173\u8054\u5bf9\u8c61\u4e00\u5b9a\u5b58\u5728\uff0c\u5173\u8054\u5bf9\u8c61\u4e0d\u5b58\u5728\u4f1a\u5bfc\u81f4\u95ee\u9898\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u6240\u4ee5\uff0c\u8fd9\u4e2a\u95ee\u9898\u662f\u77ed\u5173\u8054\u7279\u6709\u7684\u3002\u5728\u540e\u7eed\u4f8b\u5b50\u4e2d\uff0c\u6240\u6709\u5173\u8054\u5bf9\u8c61\u90fd\u662fid-only\u5bf9\u8c61\u3002"}),"\n",(0,s.jsxs)(e.p,{children:["\u5728",(0,s.jsx)(e.a,{href:"../../mapping/base/foreignkey",children:"\u6620\u5c04\u7bc7/\u57fa\u7840\u6620\u5c04/\u771f\u5047\u5916\u952e"}),"\u4e2d\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86Jimmer\u652f\u6301\u771f\u5047\u4e24\u79cd\u5916\u952e\u3002\n\u53ea\u6709\u771f\u5916\u952e\u624d\u4f1a\u6d89\u53ca\u5230\u6570\u636e\u5e93\u7ea6\u675f\u8fdd\u80cc\u95ee\u9898\uff0c\u6240\u4ee5\u6211\u4eec\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\u3002"]}),"\n",(0,s.jsx)(e.h3,{id:"\u5047\u5916\u952e",children:"\u5047\u5916\u952e"}),"\n",(0,s.jsx)(e.p,{children:"\u5bf9\u4e8e\u5047\u5916\u952e\u800c\u8a00\uff0c\u6570\u636e\u5e93\u4e2d\u4e0d\u5b58\u5728\u5916\u952e\u7ea6\u675f\uff0c\u5982\u679c\u6307\u5b9a\u7684\u5173\u8054\u5bf9\u8c61\u4e0d\u5b58\u5728\uff0c\u5373\uff0c\u5173\u8054id\u975e\u6cd5\uff0c\u6570\u636e\u5e93\u5bf9\u6b64\u6beb\u65e0\u610f\u89c1\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u6240\u4ee5\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cJimmer\u4e0d\u4f1a\u4e3a\u5047\u5916\u952e\u5224\u65ad\u5173\u8054\u5bf9\u8c61\u662f\u5426\u5b58\u5728\uff0c\u5141\u8bb8\u7528\u6237\u4fdd\u5b58\u975e\u6cd5\u7684\u60ac\u6302\u503c\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u867d\u7136\u8fd9\u548c\u672c\u6587\u7684\u4e3b\u9898\u65e0\u5173\uff0c\u4f46\u672c\u6587\u4ecd\u7ed9\u4e88\u9610\u8ff0\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u4fdd\u5b58\u6307\u4ee4\u8ba9Jimmer\u4e8b\u5148\u9a8c\u8bc1\u5173\u8054\u5bf9\u8c61\u662f\u5426\u5b58\u5728\u3002"}),"\n",(0,s.jsx)(e.admonition,{type:"info",children:(0,s.jsxs)(e.p,{children:["\u5047\u8bbe",(0,s.jsx)(e.code,{children:"Book.store"}),"\u662f\u5047\u5916\u952e"]})}),"\n",(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"List<Book> books = Arrays.asList(\n        Immutables.createBook(draft -> {\n            draft.setId(8L);\n            draft.setStoreId(2L);\n        }),\n        Immutables.createBook(draft -> {\n            draft.setId(9L);\n            draft.setStoreId(999L); // Invalid associated id\n        })\n);\n\nsqlClient\n        .saveEntitiesCommand(books)\n        .setMode(SaveMode.UPDATE_ONLY)\n        // highlight-next-line\n        .setAutoIdOnlyTargetChecking(\n                BookProps.STORE\n        )\n        .execute();\n"})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:"val books = listOf(\n    Book {\n        id = 8L\n        storeId = 2L\n    },\n    Book {\n        id = 9L\n        storeId = 999L // Invalid associated id\n    }\n)\n\nsqlClient.updateEntities(books) {\n    // highlight-next-line\n    setAutoIdOnlyTargetChecking(\n        Book::store\n    )\n}\n"})})})]}),"\n",(0,s.jsxs)(e.p,{children:["\u8fd9\u91cc\uff0c\u901a\u8fc7",(0,s.jsx)(e.code,{children:"setAutoIdOnlyTargetChecking"}),"\u65b9\u6cd5\u8bbe\u7f6e\u9700\u8981\u4e8b\u5148\u9a8c\u8bc1\u7684\u77ed\u5173\u8054\u3002"]}),"\n",(0,s.jsx)(e.p,{children:"\u5728\u4fdd\u5b58\u6570\u636e\u4e4b\u524d\uff0cJimmer\u4f1a\u901a\u8fc7\u67e5\u8be2\u9a8c\u8bc1\u5173\u8054id\u662f\u5426\u5408\u6cd5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"select\n    tb_1_.ID\nfrom BOOK_STORE tb_1_\nwhere\n    -- highlight-next-line\n    tb_1_.ID = any(? /* [2, 999] */)\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u6700\u7ec8\u629b\u51fa\u5982\u4e0b\u5f02\u5e38"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sh",children:'#highlight-next-line\norg.babyfish.jimmer.sql.exception.SaveException$IllegalTargetId: \n    Save error caused by the path: "<root>.store": \n    Cannot save the entity, the associated id of the reference \n    property "com.yourcompany.yourproject.model.Book.store" is \n    #highlight-next-line\n    "999" but there is no corresponding associated object in the database\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u771f\u5916\u952e",children:"\u771f\u5916\u952e"}),"\n",(0,s.jsx)(e.p,{children:"\u5bf9\u4e8e\u771f\u5916\u952e\u800c\u8a00\uff0c\u6570\u636e\u5e93\u4e2d\u5b58\u5728\u5916\u952e\u7ea6\u675f\uff0c\u5982\u679c\u6307\u5b9a\u7684\u5173\u8054\u5bf9\u8c61\u4e0d\u5b58\u5728\uff0c\u5373\uff0c\u5173\u8054id\u975e\u6cd5\uff0c\u6570\u636e\u5e93\u4f1a\u62a5\u544a\u8fdd\u80cc\u7ea6\u675f\u5f02\u5e38\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u65e0\u9700\u7528\u6237\u8fdb\u884c\u4efb\u4f55\u8bbe\u7f6e\uff0c\u5982\u679c\u53d1\u751f\u4e86\u9519\u8bef\uff0cJimmer\u4f1a\u81ea\u52a8\u5bf9\u6570\u636e\u5e93\u62a5\u544a\u7684\u9519\u8bef\u8fdb\u884c\u5206\u6790\uff0c\u627e\u51fa\u975e\u6cd5\u7684\u5173\u8054id\u3002"}),"\n",(0,s.jsx)(e.admonition,{type:"info",children:(0,s.jsxs)(e.p,{children:["\u5047\u8bbe",(0,s.jsx)(e.code,{children:"Book.store"}),"\u662f\u771f\u5916\u952e"]})}),"\n",(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"List<Book> books = Arrays.asList(\n        Immutables.createBook(draft -> {\n            draft.setId(8L);\n            draft.setStoreId(2L);\n        }),\n        Immutables.createBook(draft -> {\n            draft.setId(9L);\n            // highlight-next-line\n            draft.setStoreId(999L); // Invalid associated id\n        })\n);\n\nsqlClient.updateEntities(books);\n"})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:"val books = listOf(\n    Book {\n        id = 8L\n        storeId = 2L\n    },\n    Book {\n        id = 9L\n        // highlight-next-line\n        storeId = 999L // Invalid associated id\n    }\n)\n\nsqlClient.updateEntities(books)\n"})})})]}),"\n",(0,s.jsx)(e.p,{children:"\u8fd9\u6bb5\u4ee3\u7801\u4f1a\u751f\u4ea7\u5982\u4e0b\u4e24\u6761SQL"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u6279\u91cf\u66f4\u65b0\u6570\u636e"}),"\n",(0,s.jsxs)(a.A,{groupId:"database",children:[(0,s.jsx)(r.A,{value:"h2",label:"\u7edd\u5927\u90e8\u5206\u6570\u636e\u5e93",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"update BOOK\nset\n    STORE_ID = ? /*  */\nwhere\n    ID = ? /*  */\n/* batch-0: [2, 8] */\n-- highlight-next-line\n/* batch-1: [999, 9] */\n"})})}),(0,s.jsxs)(r.A,{value:"mysql",label:"Mysql",children:[(0,s.jsx)(e.admonition,{type:"caution",children:(0,s.jsxs)(e.p,{children:["\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cMySQL\u7684\u6279\u91cf\u64cd\u4f5c\u4e0d\u4f1a\u88ab\u91c7\u7528\uff0c\u800c\u91c7\u7528\u591a\u6761SQL\u3002\u5177\u4f53\u7ec6\u8282\u8bf7\u53c2\u8003",(0,s.jsx)(e.a,{href:"./mysql",children:"MySQL\u7684\u95ee\u9898"})]})}),(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"update BOOK\nset\n    STORE_ID = ? /* 2 */\nwhere\n    ID = ? /* 8 */\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"update BOOK\nset\n    -- highlight-next-line\n    STORE_ID = ? /* 999 */\nwhere\n    ID = ? /* 9 */\n"})}),"\n"]}),"\n"]})]})]}),"\n",(0,s.jsxs)(e.p,{children:["\u5176\u4e2d\uff0c\u4fee\u6539\u7b2c\u4e8c\u6761\u6570\u636e\u4f1a\u5bfc\u81f4",(0,s.jsx)(e.code,{children:"STORE_ID"}),"\u5217\u7684\u5916\u952e\u7ea6\u675f\u88ab\u8fdd\u80cc\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u8c03\u67e5\u8fdd\u53cd\u7ea6\u675f\u7684\u539f\u56e0"}),"\n",(0,s.jsxs)(a.A,{groupId:"database",children:[(0,s.jsx)(r.A,{value:"scenario-1",label:"\u573a\u666f1",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- highlight-next-line\nPurpose: COMMAND(INVESTIGATE_CONSTRAINT_VIOLATION_ERROR)\nSQL: select\n    tb_1_.ID\nfrom BOOK_STORE tb_1_\nwhere\n    tb_1_.ID = ? /* 999 */\n"})})}),(0,s.jsx)(r.A,{value:"scenario-2",label:"\u573a\u666f2",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- highlight-next-line\nPurpose: COMMAND(INVESTIGATE_CONSTRAINT_VIOLATION_ERROR)\nSQL: select\n    tb_1_.ID\nfrom BOOK_STORE tb_1_\nwhere\n    tb_1_.ID = any(? /* [2, 999] */)\n"})})})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u573a\u666f1"}),"\n",(0,s.jsxs)(e.p,{children:["\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u6839\u636e\u6279\u91cf\u64cd\u4f5c\u5bfc\u81f4\u7684",(0,s.jsx)(e.code,{children:"java.sql.BatchUpdateException"}),"\u5224\u65ad\u662f\u54ea\u6761\u6570\u636e\u8fdd\u80cc\u4e86\u7ea6\u675f\uff0c\u53ea\u9700\u5bf9\u51fa\u9519\u7684\u90a3\u6761\u6570\u636e\u8fdb\u884c\u8c03\u67e5"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u573a\u666f2"}),"\n",(0,s.jsxs)(e.p,{children:["\u4e0d\u7406\u60f3\u7684\u60c5\u51b5\u4e0b\uff0c\u65e0\u6cd5\u6839\u636e\u6279\u91cf\u64cd\u4f5c\u5bfc\u81f4\u7684",(0,s.jsx)(e.code,{children:"java.sql.BatchUpdateException"}),"\u5224\u65ad\u662f\u54ea\u6761\u6570\u636e\u8fdd\u80cc\u4e86\u7ea6\u675f\uff0c\u4e0d\u5f97\u4e0d\u5bf9\u6240\u6709\u6570\u636e\u8fdb\u884c\u8c03\u67e5"]}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsxs)(e.p,{children:["Postgres\u4ee5\u53ca\u542f\u7528\u4e86\u6279\u91cf\u5316\u80fd\u529b\u7684MySQL(\u53c2\u89c1",(0,s.jsx)(e.a,{href:"./mysql",children:"MySQL\u7684\u95ee\u9898"}),")\uff0c\u90fd\u5c5e\u4e8e\u8fd9\u79cd\u573a\u666f"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u65e0\u8bba\u5982\u4f55\uff0cJimmer\u90fd\u80fd\u8c03\u67e5\u51fa\u95ee\u9898\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u6700\u7ec8\uff0cJimmer\u4f1a\u6839\u636e\u8c03\u67e5\u7ed3\u679c\u629b\u51fa\u5f02\u5e38"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sh",children:'#highlight-next-line\norg.babyfish.jimmer.sql.exception.SaveException$IllegalTargetId: \n    Save error caused by the path: "<root>.store": \n    Cannot save the entity, the associated id of the reference \n    property "com.yourcompany.yourproject.model.Book.store" is \n    #highlight-next-line\n    "999" but there is no corresponding associated object in the database\n'})}),"\n",(0,s.jsx)(e.admonition,{type:"tip",children:(0,s.jsx)(e.p,{children:"\u53ef\u89c1\uff0c\u867d\u7136\u771f\u5916\u952e\u7684\u9519\u8bef\u81ea\u52a8\u8c03\u67e5\u548c\u5047\u5916\u952e\u7684\u624b\u52a8\u68c0\u67e5\u673a\u5236\u5b8c\u5168\u4e0d\u540c\uff0c\u4f46\u4e8c\u8005\u5f97\u5230\u5f02\u5e38\u4fe1\u606f\u5b8c\u5168\u4e00\u6837\u3002"})}),"\n",(0,s.jsx)(e.h2,{id:"\u7528\u6237\u5f02\u5e38\u7ffb\u8bd1\u5668",children:"\u7528\u6237\u5f02\u5e38\u7ffb\u8bd1\u5668"}),"\n",(0,s.jsx)(e.h3,{id:"\u5f02\u5e38\u7ffb\u8bd1\u63a5\u53e3",children:"\u5f02\u5e38\u7ffb\u8bd1\u63a5\u53e3"}),"\n",(0,s.jsx)(e.p,{children:"\u5982\u524d\u6587\u6240\u8bb2\uff0cJimmer\u8c03\u67e5\u6570\u636e\u5e93\u62a5\u544a\u7684\u8fdd\u53cd\u7ea6\u675f\u7684\u9519\u8bef\uff0c\u5e76\u629b\u51fa\u5f02\u5e38"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"org.babyfish.jimmer.sql.exception.SaveException.NotUnique"})}),"\n",(0,s.jsx)(e.p,{children:"\u8fdd\u53cd\u4e3b\u952e\u7ea6\u675f\u3001\u552f\u4e00\u7ea6\u675f\u6216\u552f\u4e00\u7d22\u5f15"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"org.babyfish.jimmer.sql.exception.SaveException.IllegalTargetId"})}),"\n",(0,s.jsx)(e.p,{children:"\u975e\u6cd5\u7684\u5173\u8054id"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u8fd9\u4e24\u4e2a\u5f02\u5e38\u4e0d\u4f46\u63d0\u4f9b\u8be6\u5c3d\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u8fd8\u63d0\u4f9b\u4e30\u5bcc\u7684API\u4ee5\u83b7\u53d6\u5404\u79cd\u4fe1\u606f\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u4f46\u662f\uff0c\u8fd8\u8fdc\u8fdc\u4e0d\u591f\uff0c\u5b9e\u9645\u9879\u76ee\u4e2d\uff0c\u6211\u4eec\u5fc5\u987b\u4e3a\u6700\u7ec8\u7528\u6237\u5c55\u793a\u901a\u4fd7\u6613\u61c2\u7684\u4fe1\u606f\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u8bda\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6bcf\u6b21\u8c03\u7528\u4fdd\u5b58\u6307\u4ee4\u540e\u6355\u83b7\u5f02\u5e38\u5e76\u5904\u7406\u3002\u7136\u800c\uff0cJimmer\u652f\u6301\u66f4\u5f3a\u5927\u7edf\u4e00\u5f02\u5e38\u7ffb\u8bd1\u3002"}),"\n",(0,s.jsxs)(e.p,{children:["Jimmer\u63d0\u4f9b\u4e86\u5f02\u5e38\u7ffb\u8bd1\u63a5\u53e3",(0,s.jsx)(e.code,{children:"ExceptionTranslator"}),"\uff0c\u4ee3\u7801\u5982\u4e0b"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",metastring:'title="ExceptionTranslator.java"',children:"package org.babyfish.jimmer.sql.runtime;\n\npublic interface ExceptionTranslator<E extends Exception> {\n\n    /**\n     * Translate the exception.\n     *\n     * <p>If the exception is not known how to be translated,\n     * return null or the original argument.</p>\n     */\n    @Nullable\n    Exception translate(@NotNull E exception, @NotNull Args args);\n\n    interface Args {\n        ...\u7565...\n    }\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u7c7b\u5b9e\u73b0\u6b64\u63a5\u53e3 ",(0,s.jsx)(e.em,{children:"(\u6ce8\u610f\uff0c\u4e0d\u80fd\u7528lambda\u8868\u8fbe\u5f0f)"}),"\uff0c\u5e76\u4e3a\u63a5\u53e3\u6307\u5b9a\u8303\u578b\u53f7\u53c2\u6570\uff0c\u4f8b\u5982"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u7ffb\u8bd1",(0,s.jsx)(e.code,{children:"SaveException.NotUnique"}),"\u5f02\u5e38"]}),"\n",(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"public class NotUniqueExceptionTranslator\nextends ExceptionTranslator<\n    // highlight-next-line\n    SaveException.NotUnique\n> {\n    ...\u7565...\n}\n"})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:"class NotUniqueExceptionTranslator :\nExceptionTranslator<\n    // highlight-next-line\n    SaveException.NotUnique\n> {\n    ...\u7565...\n}\n"})})})]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u7ffb\u8bd1",(0,s.jsx)(e.code,{children:"SaveException.IllegalTargetId"}),"\u5f02\u5e38"]}),"\n",(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"public class IllegalTargetIdExceptionTranslator\nextends ExceptionTranslator<\n    // highlight-next-line\n    SaveException.IllegalTargetId\n> {\n    ...\u7565...\n}\n"})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:"class IllegalTargetIdExceptionTranslator :\nExceptionTranslator<\n    // highlight-next-line\n    SaveException.IllegalTargetId\n> {\n    ...\u7565...\n}\n"})})})]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u751a\u81f3\u53ef\u4ee5\u7ffb\u8bd1Jimmer\u4e0d\u611f\u5174\u8da3\u7684\u5176\u4ed6JDBC\u5f02\u5e38"}),"\n",(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"public class SQLExceptionTranslator\nextends ExceptionTranslator<\n    // highlight-next-line\n    java.sql.SQLException\n> {\n    ...\u7565...\n}\n"})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:"class SQLExceptionTranslator :\nExceptionTranslator<\n    // highlight-next-line\n    java.sql.SQLException\n> {\n    ...\u7565...\n}\n"})})})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"\u591a\u79cd\u6ce8\u518c\u65b9\u6cd5",children:"\u591a\u79cd\u6ce8\u518c\u65b9\u6cd5"}),"\n",(0,s.jsx)(e.p,{children:"\u53ea\u7f16\u5199\u4e00\u4e2a\u7c7b\u5b9e\u73b0\u6b64\u63a5\u53e3\u662f\u6ca1\u7528\u7684\uff0c\u5fc5\u987b\u521b\u5efa\u5bf9\u8c61\u5e76\u5c06\u4e4b\u6ce8\u518c\u5230Jimmer\u65b9\u53ef\u751f\u6548\u3002"}),"\n",(0,s.jsxs)(e.p,{children:["Jimmer\u63d0\u4f9b\u4e24\u79cd\u6ce8\u518c\u65b9\u6cd5\uff0c\u4ee5\u4e0a\u6587\u63d0\u53ca\u7684",(0,s.jsx)(e.code,{children:"NotUniqueExceptionTranslator"}),"\u4e3a\u4f8b\uff1a"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5168\u5c40\u6ce8\u518c\uff0c\u53c8\u53ef\u5206\u4e3a\u4e24\u79cd"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u4e0d\u4f7f\u7528Jimmer\u7684spring starter"}),"\n",(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"JSqlClient sqlClient = JSqlClient\n    .newBuilder()\n    // highlight-next-line\n    .addExceptionTranslator(\n        new NotUniqueExceptionTranslator()\n    )\n    ...\u7701\u7565\u5176\u4ed6\u914d\u7f6e...\n    .build();\n"})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:"val sqlClient = sqlClient {\n    // highlight-next-line\n    addExceptionTranslator(\n        NotUniqueExceptionTranslator()\n    )\n    ...\u7701\u7565\u5176\u4ed6\u914d\u7f6e...\n}\n"})})})]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u4f7f\u7528Jimmer\u7684spring starter"}),"\n",(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"// highlight-next-line\n@Component\npublic class NotUniqueExceptionTranslator\nextends ExceptionTranslator<SaveException.NotUnique> {\n    ...\u7565...\n}\n"})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:"// highlight-next-line\n@Component\nclass NotUniqueExceptionTranslator :\nExceptionTranslator<SaveException.NotUnique> {\n    ...\u7565...\n}\n"})})})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u4e3a\u7279\u5b9a\u4fdd\u5b58\u6307\u4ee4\u6ce8\u518c"}),"\n",(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"Book book = ...\u7565...;\n\nsqlClient\n    .saveCommand(book)\n    // highlight-next-line\n    .addExceptionTranslator(\n        new NotUniqueExceptionTranslator()\n    )\n    .execute()\n"})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:"val book: Book = ...\u7565...\n\nsqlClient.save(book) {\n    // highlight-next-line\n    addExceptionTranslator(\n        new NotUniqueExceptionTranslator()\n    )\n}\n"})})})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.h3,{id:"\u5b9e\u73b0translate\u65b9\u6cd5",children:["\u5b9e\u73b0",(0,s.jsx)(e.code,{children:"translate"}),"\u65b9\u6cd5"]}),"\n",(0,s.jsxs)(e.p,{children:["\u6700\u540e\uff0c\u6211\u4eec\u6765\u5c55\u793a\u5982\u4f55\u5b9e\u73b0\u7684",(0,s.jsx)(e.code,{children:"translate"}),"\u65b9\u6cd5"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u7ffb\u8bd1",(0,s.jsx)(e.code,{children:"SaveException.NotUnique"}),"\u5f02\u5e38"]}),"\n",(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'@Component\npublic class NotUniqueExceptionTranslator\nextends ExceptionTranslator<SaveException.NotUnique> {\n    \n    @Override\n    public @Nullable Exception translate(\n        @NotNull SaveException.NotUnique exception, \n        @NotNull Args args\n    ) {\n        \n        // highlight-next-line\n        if (exception.isMatched(BookProps.ID)) {\n            return new IllegalArgumentException(\n                    "ID\u4e3a" +\n                            exception.getValue(BookProps.ID) +\n                            "\u7684\u4e66\u7c4d\u5df2\u7ecf\u5b58\u5728"\n            );\n        }\n        \n        // highlight-next-line\n        if (exception.isMatched(BookProps.NAME, BookProps.EDITION)) {\n            return new IllegalArgumentException(\n                    "\u540d\u79f0\u4e3a" +\n                            exception.getValue(BookProps.NAME) +\n                            "\u4e14\u7248\u672c\u4e3a" +\n                            exception.getValue(BookProps.EDITION) +\n                            "\u7684\u4e66\u7c4d\u5df2\u7ecf\u5b58\u5728"\n            );\n        }\n        \n        //\u4e0d\u505a\u5904\u7406\uff0c\u4e5f\u53ef\u4ee5\u5199\u6210`return exception`\n        return null;\n    }\n}\n'})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:'@Component\nclass NotUniqueExceptionTranslator :\nExceptionTranslator<SaveException.NotUnique> {\n\n    override fun translate(\n        exception: NotUnique, \n        args: ExceptionTranslator.Args\n    ): Exception? =\n        when {\n            // highlight-next-line\n            exception.isMatched(Book::id) ->\n                throw IllegalArgumentException(\n                    "ID\u4e3a${exception[Book::id]}\u7684\u4e66\u7c4d\u5df2\u7ecf\u5b58\u5728"\n                )\n            // highlight-next-line\n            exception.isMatched(Book::name, Book::edition) ->\n                throw IllegalArgumentException(\n                    "\u540d\u79f0\u4e3a${\n                        exception[Book::id]\n                    }\u4e14\u7248\u672c\u4e3a${\n                        exception[Book::edition]\n                    }\u7684\u4e66\u7c4d\u5df2\u7ecf\u5b58\u5728"\n                )\n            else ->\n                null //\u4e0d\u505a\u5904\u7406\uff0c\u4e5f\u53ef\u4ee5\u5199\u4f5c`exception`\n        }\n}\n'})})})]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u7ffb\u8bd1",(0,s.jsx)(e.code,{children:"SaveException.IllegalTargetId"}),"\u5f02\u5e38"]}),"\n",(0,s.jsxs)(a.A,{groupId:"language",children:[(0,s.jsx)(r.A,{value:"java",label:"Java",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'@Component\npublic class IllegalTargetIdExceptionTranslator\nextends ExceptionTranslator<SaveException.IllegalTargetId> {\n    \n    @Override\n    public @Nullable Exception translate(\n            @NotNull SaveException.IllegalTargetId exception,\n            @NotNull Args args\n    ) {\n        if (exception.getProp() == BookProps.STORE.unwrap()) {\n            throw new IllegalArgumentException(\n                    "\u65e0\u6cd5\u4e3a\u4e66\u7c4d\u8bbe\u7f6e\u975e\u6cd5\u7684\u5173\u8054\u4e66\u5e97ID: " +\n                            exception.getTargetIds()\n            );\n        }\n\n        // \u4e0d\u505a\u5904\u7406\uff0c\u4e5f\u53ef\u5199\u4f5c`return exception`\n        return null;\n    }\n}\n'})})}),(0,s.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:'@Component\nclass IllegalTargetIdExceptionTranslator :\nExceptionTranslator<SaveException.IllegalTargetId> {\n\n    override fun translate(\n        exception: IllegalTargetId,\n        args: ExceptionTranslator.Args\n    ): Exception? =\n        when {\n            // highlight-next-line\n            exception.prop == BookProps.STORE.unwrap() ->\n                throw IllegalArgumentException(\n                    "\u65e0\u6cd5\u4e3a\u4e66\u7c4d\u8bbe\u7f6e\u975e\u6cd5\u7684\u5173\u8054\u4e66\u5e97ID: ${\n                        exception.targetIds\n                    }"\n                )\n            else ->\n                null //\u4e0d\u505a\u5904\u7406\uff0c\u4e5f\u53ef\u4ee5\u5199\u4f5c`exception`\n        }\n}\n'})})})]}),"\n"]}),"\n"]})]})}function g(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(j,{...n})}):j(n)}},19365:(n,e,l)=>{l.d(e,{A:()=>a});l(96540);var i=l(34164);const s={tabItem:"tabItem_Ymn6"};var t=l(74848);function a(n){let{children:e,hidden:l,className:a}=n;return(0,t.jsx)("div",{role:"tabpanel",className:(0,i.A)(s.tabItem,a),hidden:l,children:e})}},11470:(n,e,l)=>{l.d(e,{A:()=>E});var i=l(96540),s=l(34164),t=l(23104),a=l(56347),r=l(205),o=l(57485),c=l(31682),d=l(70679);function h(n){return i.Children.toArray(n).filter((n=>"\n"!==n)).map((n=>{if(!n||(0,i.isValidElement)(n)&&function(n){const{props:e}=n;return!!e&&"object"==typeof e&&"value"in e}(n))return n;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof n.type?n.type:n.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function x(n){const{values:e,children:l}=n;return(0,i.useMemo)((()=>{const n=e??function(n){return h(n).map((n=>{let{props:{value:e,label:l,attributes:i,default:s}}=n;return{value:e,label:l,attributes:i,default:s}}))}(l);return function(n){const e=(0,c.XI)(n,((n,e)=>n.value===e.value));if(e.length>0)throw new Error(`Docusaurus error: Duplicate values "${e.map((n=>n.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(n),n}),[e,l])}function u(n){let{value:e,tabValues:l}=n;return l.some((n=>n.value===e))}function p(n){let{queryString:e=!1,groupId:l}=n;const s=(0,a.W6)(),t=function(n){let{queryString:e=!1,groupId:l}=n;if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!l)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return l??null}({queryString:e,groupId:l});return[(0,o.aZ)(t),(0,i.useCallback)((n=>{if(!t)return;const e=new URLSearchParams(s.location.search);e.set(t,n),s.replace({...s.location,search:e.toString()})}),[t,s])]}function j(n){const{defaultValue:e,queryString:l=!1,groupId:s}=n,t=x(n),[a,o]=(0,i.useState)((()=>function(n){let{defaultValue:e,tabValues:l}=n;if(0===l.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!u({value:e,tabValues:l}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${l.map((n=>n.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const i=l.find((n=>n.default))??l[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:e,tabValues:t}))),[c,h]=p({queryString:l,groupId:s}),[j,g]=function(n){let{groupId:e}=n;const l=function(n){return n?`docusaurus.tab.${n}`:null}(e),[s,t]=(0,d.Dv)(l);return[s,(0,i.useCallback)((n=>{l&&t.set(n)}),[l,t])]}({groupId:s}),m=(()=>{const n=c??j;return u({value:n,tabValues:t})?n:null})();(0,r.A)((()=>{m&&o(m)}),[m]);return{selectedValue:a,selectValue:(0,i.useCallback)((n=>{if(!u({value:n,tabValues:t}))throw new Error(`Can't select invalid tab value=${n}`);o(n),h(n),g(n)}),[h,g,t]),tabValues:t}}var g=l(92303);const m={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=l(74848);function v(n){let{className:e,block:l,selectedValue:i,selectValue:a,tabValues:r}=n;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,t.a_)(),d=n=>{const e=n.currentTarget,l=o.indexOf(e),s=r[l].value;s!==i&&(c(e),a(s))},h=n=>{let e=null;switch(n.key){case"Enter":d(n);break;case"ArrowRight":{const l=o.indexOf(n.currentTarget)+1;e=o[l]??o[0];break}case"ArrowLeft":{const l=o.indexOf(n.currentTarget)-1;e=o[l]??o[o.length-1];break}}e?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":l},e),children:r.map((n=>{let{value:e,label:l,attributes:t}=n;return(0,b.jsx)("li",{role:"tab",tabIndex:i===e?0:-1,"aria-selected":i===e,ref:n=>o.push(n),onKeyDown:h,onClick:d,...t,className:(0,s.A)("tabs__item",m.tabItem,t?.className,{"tabs__item--active":i===e}),children:l??e},e)}))})}function I(n){let{lazy:e,children:l,selectedValue:t}=n;const a=(Array.isArray(l)?l:[l]).filter(Boolean);if(e){const n=a.find((n=>n.props.value===t));return n?(0,i.cloneElement)(n,{className:(0,s.A)("margin-top--md",n.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:a.map(((n,e)=>(0,i.cloneElement)(n,{key:e,hidden:n.props.value!==t})))})}function f(n){const e=j(n);return(0,b.jsxs)("div",{className:(0,s.A)("tabs-container",m.tabList),children:[(0,b.jsx)(v,{...e,...n}),(0,b.jsx)(I,{...e,...n})]})}function E(n){const e=(0,g.A)();return(0,b.jsx)(f,{...n,children:h(n.children)},String(e))}},66971:(n,e,l)=>{l.d(e,{a:()=>j});var i=l(96540),s=l(72774),t=l(63051),a=l(28968),r=l(48875),o=l(44676),c=l(47859),d=l(4671),h=l(99343),x=l(7324),u=l(39781),p=l(74848);const j=(0,i.memo)((n=>{let{open:e,fullScreen:l=!1,title:r,maxWidth:j="md",onClose:m,children:b}=n;const[v,I]=(0,i.useState)(l),f=(0,i.useCallback)((()=>{I((n=>!n))}),[]);return(0,p.jsxs)(t.A,{open:e,onClose:m,fullScreen:v,TransitionComponent:g,maxWidth:j,children:[(0,p.jsx)(s.A,{sx:{position:"relative"},children:(0,p.jsxs)(o.A,{children:[(0,p.jsx)(c.A,{sx:{ml:2,flex:1},variant:"h6",component:"div",children:r}),(0,p.jsx)(d.A,{onClick:f,style:{color:"white"},children:v?(0,p.jsx)(x.A,{}):(0,p.jsx)(h.A,{})}),(0,p.jsx)(d.A,{"aria-label":"close",onClick:m,style:{color:"white"},children:(0,p.jsx)(u.A,{})})]})}),(0,p.jsx)(a.A,{children:b})]})})),g=i.forwardRef((function(n,e){return(0,p.jsx)(r.A,{direction:"up",ref:e,...n})}))},74400:(n,e,l)=>{l.d(e,{l:()=>r});var i=l(96540),s=l(67512),t=l(66971),a=l(74848);const r=(0,i.memo)((n=>{let{buttonText:e,fullScreen:l=!1,title:r=e,variant:o="outlined",large:c=!1,maxWidth:d,useOriginalText:h=!0,children:x}=n;const[u,p]=(0,i.useState)(!1),j=(0,i.useCallback)((n=>{p(!0),n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}),[]),g=(0,i.useCallback)((()=>{p(!1)}),[]),m=h?{textTransform:"none"}:{};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.A,{"data-is-view-more-button":"true",onClick:j,variant:o,size:c?"large":"small",style:m,children:e}),(0,a.jsx)(t.a,{open:u,onClose:g,title:r,maxWidth:d,fullScreen:l,children:x})]})}))},28453:(n,e,l)=>{l.d(e,{R:()=>a,x:()=>r});var i=l(96540);const s={},t=i.createContext(s);function a(n){const e=i.useContext(t);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),i.createElement(t.Provider,{value:e},n.children)}}}]);